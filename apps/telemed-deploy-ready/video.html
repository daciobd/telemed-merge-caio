<!doctype html>
<html lang="pt-BR">
<head>
  <meta charset="utf-8"/>
  <meta name="viewport" content="width=device-width,initial-scale=1"/>
  <title>TeleMed — Vídeo</title>
  <style>
    html,body{height:100%;margin:0;background:#0b1220;color:#e2e8f0;font:16px/1.45 system-ui}
    header{padding:10px 14px;border-bottom:1px solid #1e293b;background:#0f172a;display:flex;gap:12px;align-items:center}
    main{height:calc(100% - 56px)}
    .input{background:#0b1220;border:1px solid #1e293b;border-radius:10px;color:#e2e8f0;padding:8px 10px}
    .btn{background:#0ea5e9;border:1px solid #065f92;color:#fff;border-radius:10px;padding:8px 12px;font-weight:600;cursor:pointer}
    .btn.ghost{background:transparent;color:#93c5fd;border-color:#1e293b}
  </style>
  <script src="https://8x8.vc/external_api.js"></script>
</head>
<body>
  <header>
    <strong>TeleMed — Vídeo</strong>
    <input id="room" class="input" placeholder="room (ex.: appointmentId)"/>
    <button id="join" class="btn">Entrar</button>
    <span style="flex:1"></span>
    <a class="btn ghost" href="/example-integration.html">Voltar ao Hub</a>
  </header>
  <main id="stage"></main>

  <script>
  (function(){
    const JITSI_DOMAIN = 'meet.jit.si'; // pode trocar por domínio próprio
    const qs = new URLSearchParams(location.search);
    const roomEl = document.getElementById('room');
    const joinBtn = document.getElementById('join');
    const stage = document.getElementById('stage');

    roomEl.value = qs.get('room') || '';

    let api = null;
    function join(room){
      if (!room) { alert('Informe o room (ex.: appointmentId)'); return; }
      if (api) { api.dispose(); api = null; }
      stage.innerHTML = '';
      const opts = {
        roomName: room,
        width: '100%',
        height: '100%',
        parentNode: stage,
        configOverwrite: { prejoinConfig: { enabled: true } },
        interfaceConfigOverwrite: {}
      };
      api = new JitsiMeetExternalAPI(JITSI_DOMAIN, opts);
    }

    joinBtn.onclick = ()=> join(roomEl.value.trim());
    if (roomEl.value) join(roomEl.value);
  })();
  </script>
</body>
</html>